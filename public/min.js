let loading=!1;const redirect=async e=>{if(e.preventDefault(),loading)return;loading=!0;const o=e.target.href,a=setTimeout((()=>window.location.href=o),5e3),t=await fetch(o,{method:"POST",body:JSON.stringify({header:!1}),headers:{"Content-Type":"application/json"}});clearTimeout(a),document.body.innerHTML=await t.text(),document.querySelectorAll("a").forEach((e=>e.onclick=redirect));const n=(o||"/").replace(window.location.origin,"");updateURL(n,!0),update(),loading=!1},updateURL=(e,o)=>{o&&window.history.pushState({},"",e);const a=e.replaceAll("/","").replace("signup","sign up").replace(/(^\w{1})|(\s+\w{1})/g,(e=>e.toUpperCase()));document.title="/join"==window.location.pathname?"Play "+appName+"! Enter game code here | "+appName:a?a+" | "+appName:e.split("?")[0].endsWith("/")?appName+" - live learning game show":appName},validateEmail=e=>String(e).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|.(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),signupOrLogin=e=>{if(e.target.classList.contains("disabled"))return;const o=document.querySelector("#email");validateEmail(o.value)},updateLogin=()=>{if("/login"!=window.location.pathname&&"/signup"!=window.location.pathname)return;const e=document.querySelector("#continue");document.querySelector("#email").oninput=o=>{validateEmail(o.target.value)?e.classList.remove("disabled"):e.classList.add("disabled")},e.onclick=signupOrLogin};let gamecode=!1;const checkGamecodeOrUsername=e=>{const o=document.querySelector("#game-code");if(0==o.value.length)return;const a=document.querySelector("#form");if(gamecode){o.value}else gamecode=o.value,a.style.transform="scale(0.95)",a.style.opacity=0,setTimeout((()=>{o.value="",o.type="text",o.placeholder="Name",a.style=""}),500)},updateJoin=()=>{"/join"==window.location.pathname&&(gamecode=!1,document.querySelector("#join-game").onclick=checkGamecodeOrUsername,document.querySelector("#game-code").onkeyup=e=>"Enter"==e.key?checkGamecodeOrUsername():"")},update=()=>{document.querySelectorAll("a").forEach((e=>e.onclick=redirect)),updateLogin(),"/join"==window.location.pathname&&(gamecode=!1,document.querySelector("#join-game").onclick=checkGamecodeOrUsername,document.querySelector("#game-code").onkeyup=e=>"Enter"==e.key?checkGamecodeOrUsername():"")};window.onload=()=>update(),window.onpopstate=()=>{window.history.replaceState({},"",document.referrer),window.location=document.referrer},updateURL(window.location.pathname,!1);